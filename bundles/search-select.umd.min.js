!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms"),require("@angular/common/http"),require("@angular/cdk/overlay"),require("@angular/cdk/portal"),require("@angular/common")):"function"==typeof define&&define.amd?define("search-select",["exports","@angular/core","@angular/forms","@angular/common/http","@angular/cdk/overlay","@angular/cdk/portal","@angular/common"],t):t((e=e||self)["search-select"]={},e.ng.core,e.ng.forms,e.ng.common.http,e.ng.cdk.overlay,e.ng.cdk.portal,e.ng.common)}(this,(function(e,t,n,o,i,r,a){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function s(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)a.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a}var u=function(){function e(){this.onTypeSearch=new t.EventEmitter}return e.prototype.typeSearch=function(){this.onTypeSearch.emit()},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),s([t.Output(),l("design:type",Object)],e.prototype,"onTypeSearch",void 0),e=s([t.Injectable({providedIn:"root"}),l("design:paramtypes",[])],e)}(),p=function(){function e(e,t){var n=this;this.httpClient=e,this.searchSelectService=t,this.width=500,this.configs={},this.desconto=800,this.semResultados=!1,this.mainArray=[],this.disableScrollDetect=!1,this.searchSelectService.onTypeSearch.subscribe((function(e){n.mainArray=[],n.loadMore()}))}return e.prototype.onClickOption=function(e){this.onReturnData(e)},e.prototype.loadMore=function(){var e=this;this.semResultados=!1,this.disableScrollDetect=!0;var t=JSON.parse(JSON.stringify(this.configs)),n=t.service;t.limit=50,t.offset=this.mainArray.length,delete t.service,delete t.key,delete t.text;var i=new o.HttpParams({fromObject:t});n+=n.includes("?")?"&"+i:"?"+i,this.httpClient.get(n).subscribe((function(t){null!=t.data&&Array.isArray(t.data)&&t.data.length>0?(e.disableScrollDetect=!1,e.mainArray=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}(e.mainArray,t.data)):e.semResultados=!0}))},e.prototype.onScroll=function(e){!this.disableScrollDetect&&e.target.offsetHeight+e.target.scrollTop+this.desconto>=e.target.scrollHeight&&this.loadMore()},e.prototype.ngOnInit=function(){this.loadMore()},e.ctorParameters=function(){return[{type:o.HttpClient},{type:u}]},e=s([t.Component({selector:"ngx-options",template:'<ul class="list-group" (scroll)="onScroll($event)" [style.width.px]="width">\n\t<li class="list-group-item" *ngFor="let row of mainArray;" (click)="onClickOption(row)">{{ row[ configs[\'text\'] ] }}</li>  \n\t<li class="list-group-item" *ngIf="semResultados" (click)="onClickOption({})">Sem resultados</li>  \n</ul>',styles:['.list-group{margin-top:20px;position:absolute;z-index:5000!important;max-height:250px;width:100%;margin-bottom:10px;overflow-y:scroll}.list-group .list-group-item{cursor:pointer;color:rgba(0,0,0,.87);border:none;font-family:Roboto,"Helvetica Neue",sans-serif;font-size:16px}.list-group .list-group-item:hover{background:#007bff}']}),l("design:paramtypes",[o.HttpClient,u])],e)}(),f={provide:n.NG_VALUE_ACCESSOR,multi:!0,useExisting:t.forwardRef((function(){return h}))},h=function(){function e(e,t,n,o){this.httpClient=e,this.elementRef=t,this.overlay=n,this.searchSelectService=o,this.desconto=800,this.listEnabled=!1,this.searchString="",this.semResultados=!1,this.mainArray=[],this.disableScrollDetect=!1,this.onChange=function(e){},this.onTouched=function(){},this.defaultValue="",this.propagateChange=function(e){},this.readonly=this.readonly||!1}return e.prototype.writeValue=function(e){void 0===e&&(e=""),this.value=e,this.defaultValue=this.value,""!=this.defaultValue&&this.setDefault()},e.prototype.registerOnChange=function(e){this.propagateChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.onClearClick=function(){this.searchString="",this.configs.search="",this.value="",this.propagateChange(this.value)},e.prototype.setDefault=function(){var e=this,t=JSON.parse(JSON.stringify(this.configs)),n=t.service;t.limit=1,t.offset=0,t[this.configs.key]=this.defaultValue,delete t.service,delete t.key,delete t.text;var i=new o.HttpParams({fromObject:t});n+=n.includes("?")?"&"+i:"?"+i,this.httpClient.get(n).subscribe((function(t){if(null!=t.data&&Array.isArray(t.data)&&t.data.length>0){var n=t.data[0];null!=n&&(e.searchString=n[e.configs.text]),e.inputcomponent.nativeElement.setAttribute("disabled",e.readonly)}}))},e.prototype.onTypeSearchInput=function(){var e=this;this.keyupDelay&&clearTimeout(this.keyupDelay),this.keyupDelay=setTimeout((function(){e.configs.search=e.searchString||"",e.searchSelectService.typeSearch(),e.keyupDelay=void 0}),500)},e.prototype.toggleSelect=function(e){var t=this,n=this.overlay.position().connectedTo(this.elementRef.nativeElement,{originX:"start",originY:"center"},{overlayX:"start",overlayY:"bottom"});this.overlayRef=this.overlay.create({positionStrategy:n,hasBackdrop:!1});var o=new r.ComponentPortal(p),i=this.overlayRef.attach(o);i.instance.width=this.elementRef.nativeElement.childNodes[0].clientWidth,i.instance.configs=this.configs,i.instance.onReturnData=function(e){null!=e[t.configs.key]?(t.searchString=e[t.configs.text],t.value=e[t.configs.key],t.propagateChange(t.value)):(t.searchString="",t.configs.search="",t.value="",t.propagateChange(t.value)),setTimeout((function(){t.overlayRef.dispose()}),100)},this.overlayRef.backdropClick().subscribe((function(){t.overlayRef.dispose()}))},e.prototype.inputFocusFunction=function(e){this.toggleSelect(!0),this.onTouched&&this.onTouched()},e.prototype.onGlobalClick=function(e){var t=this;this.elementRef.nativeElement.contains(e.target)||setTimeout((function(){null!=t.overlayRef&&t.overlayRef.dispose()}),300)},e.prototype.ngOnInit=function(){var e=this;document.addEventListener("visibilitychange",(function(){null!=e.overlayRef&&(e.inputcomponent.nativeElement.blur(),e.overlayRef.dispose())})),window.addEventListener("blur",(function(){null!=e.overlayRef&&(e.inputcomponent.nativeElement.blur(),e.overlayRef.dispose())}),!1)},e.prototype.ngOnDestroy=function(){null!=this.overlayRef&&(this.inputcomponent.nativeElement.blur(),this.overlayRef.dispose())},e.ctorParameters=function(){return[{type:o.HttpClient},{type:t.ElementRef},{type:i.Overlay},{type:u}]},s([t.ViewChild("input"),l("design:type",Object)],e.prototype,"inputcomponent",void 0),s([t.Input(),l("design:type",Object)],e.prototype,"configs",void 0),s([t.Input(),l("design:type",Boolean)],e.prototype,"readonly",void 0),s([t.HostListener("document:mousedown",["$event"]),l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],e.prototype,"onGlobalClick",null),e=s([t.Component({selector:"searchSelect",template:'<div class="main-container">\n\t<input type="text" class="form-control" #input (focus)="inputFocusFunction( $event );" [(ngModel)]="searchString" (keyup)="onTypeSearchInput()"> \n\t<i *ngIf="searchString != \'\' && readonly == false " (click)="onClearClick()" class="fas fa-times text-primary"></i>\n</div>',providers:[f],styles:[".main-container{position:relative;width:100%}.main-container .fa-times{position:absolute;right:10px;top:12px;cursor:pointer}.main-container .fa-times:hover{opacity:.8}.main-container .fa-times:active{opacity:.4}"]}),l("design:paramtypes",[o.HttpClient,t.ElementRef,i.Overlay,u])],e)}(),d=function(){function e(){}return e=s([t.NgModule({declarations:[h,p],imports:[a.CommonModule,n.FormsModule],exports:[h]})],e)}();e.SearchSelectComponent=h,e.SearchSelectModule=d,e.SearchSelectService=u,e.ɵa=p,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=search-select.umd.min.js.map